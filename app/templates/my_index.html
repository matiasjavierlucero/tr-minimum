{% extends 'appbuilder/init.html' %}
{% set menu = appbuilder.menu %}

{% block body %}
     
    {% include 'appbuilder/general/confirm.html' %}
    {% include 'appbuilder/general/alert.html' %}

    {% block navbar %}
        <header class="top" role="header">
        {% include 'my_navb.html' %}
        </header>
    {% endblock %}

    <div class= "container-fluid">
        {% if not current_user.is_anonymous %}
            <div class="row" style = "display: flex;">
                <div class="col-sm-2 nav navbar-right" style= "min-width: 10%;">
                    {% include 'navbar_menu.html' %}
                </div>
                <div class="col-sm-10" style =" padding-left: 10px; min-width: 80%;">
                    {% block messages %}
                            {% include 'appbuilder/flash.html' %}
                    {% endblock %}
                    {% block content %}
                    {% endblock %}
                </div>
            </div>
        {% else %}
            <div class="col-lg-12">
                {{ self.content() }}
            </div>
        {% endif %}
    </div>

    {% block footer %}
        <footer>
        <div class="img-rounded nav-fixed-bottom">
            <div class="container">
                {% include 'appbuilder/footer.html' %}
            </div>
        </div>
        </footer>
    {% endblock %}
    <script>

        $('#s2id_marcaEquipo').appendTo('<button class="btn btn-primary" type="button" onClick="abrirmodal()">Agregar una Marca</button>')
        
        //Creo un input donde por valor tiene la cantidad de sustratos que se crearon, ya que luego debo recorrer la lista

        function abrirmodal(){
            $("#modal-id").modal('show')
        }


        function guardarmarca(){
            marca=$("#nuevamarca").val();
            $.ajax({
                    url: '/guardarMarca',
                    type: 'post',
                    dataType: 'json',
                    contentType: 'application/json',
                    data: JSON.stringify([{
                        'marca': marca
                    }]),
                    success: function (data) {
                        if (data.Mensaje == 'Correcto') {
                            window.location.reload();
                    }
                }
            })
        }


    //Quitar HREF al boton Back para que redireccione bien
    hijo=$('.fa-arrow-left')
    padre_back=hijo.parent()
    padre_back.removeAttr('href')
    padre_back.attr('onclick','volver()')
    
    function volver(){
        history.back()
    }
    
    
    </script>


<div class="modal fade" id="modal-id">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title">Agregar Marca</h4>
            </div>
            <div class="modal-body">
                <label for="marca">Marca</label>
                <input type="text" name="marca" id="nuevamarca" class="form-control" placeholder="Marca" focus="true">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" onclick='guardarmarca()' >Guardar</button>
            </div>
        
        </div>
    </div>
</div>
{% endblock %}



